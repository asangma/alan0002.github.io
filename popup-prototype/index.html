
<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>Popup Prototype</title>
  <link rel="stylesheet" href="../dijit/themes/claro/claro.css">
  <link rel="stylesheet" href="../esri/css/esri.css">
  <style>
    html,
    body {
      padding: 0;
      margin: 0;
      height: 100%;
      width: 100%;
      font-weight: 300;
    }

    .toggle {
      text-align: center;
      padding: 6px 10px;
      margin: 0 10px;
      box-sizing: border-box;
      cursor: pointer;
      line-height: normal;
      display: inline-block;
      vertical-align: middle;
      background-color: rgba(0, 0, 0, 0.5);
    }

    .toggle:hover,
    .toggle:focus {
      color: #bcdaed;
      border-color: #bcdaed;
    }

    .toggle span {
      display: inline-block;
      vertical-align: middle;
    }

    .toggle .esri-icon-expand {
      display: none;
    }

    .drawer-open .toggle .esri-icon-expand {
      display: inline-block;
    }

    .toggle .esri-icon-collapse {
      display: inline-block;
    }

    .drawer-open .toggle .esri-icon-collapse {
      display: none;
    }

    h1 {
      margin: 0;
      padding: 0;
      font-weight: normal;
    }

    .options{
      list-style: none;
      padding: 0;
      margin: 10px 0 0 0;
    }
    .options li{
      padding: 5px 0;
    }

    #mapDiv {
      padding: 0;
      margin: 0;
      width: 100%;
      height: 100%;
      position: relative;
    }

    .drawer-animation,
    .esriUI {
      -webkit-transition: left 250ms ease;
      -moz-transition: left 250ms ease;
      -ms-transition: left 250ms ease;
      -o-transition: left 250ms ease;
      transition: left 250ms ease;
    }

    .drawer-top {
      background-color: transparent;
      /*border-bottom: 1px solid #196fa6;*/
      color: #d2e9f9;
      position: absolute;
      z-index: 50;
      top: 0;
      left: 0px;
      width: 150px;
      height: 54px;
      padding: 10px 0;
      box-sizing: border-box;
    }

    .drawer-open .drawer-top {
      left: 280px;
    }

    .drawer-container {
      width: 100%;
      height: 100%;
      padding: 0;
      margin: 0;
      overflow: hidden;
      position: relative;
    }

    .drawer-side {
      color: #fff;
      position: absolute;
      top: 0;
      left: -280px;
      z-index: 51;
      width: 280px;
      height: 100%;
      padding: 20px;
      margin: 0;
      background-color: rgba(0, 0, 0, .5);
      border-right: 1px solid #052942;
      overflow: hidden;
      box-sizing: border-box;
    }

    .drawer-open .drawer-side {
      left: 0;
      overflow: auto;
      overflow-x: hidden;
    }

    .drawer-center {
      width: 100%;
      height: 100%;
      padding: 0;
      margin: 0;
    }

    code {
      padding: 0.2em;
      font-size: 85%;
      background-color: #052942;
      border-radius: 3px;
    }
  </style>
  <script>
    var package_path = window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/'));
    var dojoConfig = {
      async: true,
      isDebug: true,
      packages: [{
        name: "application",
        location: package_path + '/js'
      }],
      paths: {
        esri: "../esri"
      }
    };
  </script>

  <script src="../dojo/dojo.js"></script>

  <script>
    var map, view, popup;

    require([
      "esri/Map",
      "esri/views/MapView",
      "dojo/dom-class",
      "dojo/dom",
      "dojo/on",
      "dojo/dom-attr",
      "dojo/window",
      "esri/tasks/QueryTask",
        "esri/tasks/support/Query",
        "esri/layers/FeatureLayer",
        "esri/Graphic",
        "esri/geometry/Extent",
        "esri/geometry/Point",
        "esri/symbols/PictureMarkerSymbol",
        "esri/widgets/PopupTemplate",
        "esri/widgets/Popup",
      "dojo/domReady!"
    ], function (Map, MapView, domClass, dom, on, domAttr, win,
      QueryTask,
      Query,
      FeatureLayer,
      Graphic,
      Extent, Point,
      PictureMarkerSymbol,
      PopupTemplate,
      Popup) {

      map = new Map({
        basemap: "topo"
      });

      view = new MapView({
        container: "mapDiv",
        map: map,
         extent: new Extent({
          "xmin": -8573697.671426324,
          "ymin": 4705202.445653928,
          "xmax": -8571636.4834977,
          "ymax": 4706458.743279023,
          "spatialReference": {
            "wkid": 102100
          }
        })
      });

      // document window
      var w = win.get(document);

      // toggle button
      var btn = dom.byId("toggle");

      // When toggle button is clicked
      on(btn, "click", function (evt) {
        // toggle class
        toggle(!domClass.contains(document.body, "drawer-open"));
      }.bind(this));

      // toggles drawer open or closed
      function toggle(value) {
        domClass.toggle(document.body, "drawer-open", value);
        viewPadding();
      }

      //Sets drawer open or closed depending on the size of the window
      function drawer() {
        var vs = win.getBox(),
          value;
        // if window width is less than specified size
        if (vs.w < 850) {
          // hide drawer
          value = false;
        } else {
          // show drawer
          value = true;
        }
        toggle(value);
      }

      // applies appropriate view padding
      function viewPadding() {
        var padding;
        if (domClass.contains(document.body, "drawer-open")) {
          padding = {
            left: 280,
            top: 54
          };
        } else {
          padding = {
            left: 0,
            top: 54
          };
        }
        view.padding = padding;
      }

      // When window is resized
      on(w, 'resize', function () {
        drawer();
      });
      drawer();



      popup = new Popup({
        //position: "right",
        view: view
      });
      popup.startup();
      view.popup = popup;


      var templateHurricane = new PopupTemplate({
        title: "Hurrican Andrew",
        fieldInfos: [{ //define field infos so we can specify an alias
          fieldName: "Date",
          label: "Date:",
          visible: true
        }, {
          fieldName: "CAT",
          label: "Storm Category:",
          visible: true
        }, {
          fieldName: "PRESSURE",
          label: "Pressure:",
          visible: true
        }, {
          fieldName: "Wind_MPH",
          label: "Wind (mph):",
          visible: true
        }]
      });

      /*
      var hurricane = new FeatureLayer("http://services.arcgis.com/nzS0F0zdNLvs7nc8/ArcGIS/rest/services/05_HurricaneAndrew_1992/FeatureServer/0", {
        mode: FeatureLayer.MODE_SNAPSHOT,
        outFields: ["*"],
        popupTemplate: templateHurricane
      });


      map.add(hurricane);
      */

      var features = [new Graphic({
        geometry: new Point({
          "x": -8572600.077462012,
          "y": 4705500.594466476,
          "spatialReference": {
            "wkid": 102100
          }
        }),
        symbol: new PictureMarkerSymbol({
          url: "https://cdn0.iconfinder.com/data/icons/small-n-flat/24/678111-map-marker-128.png",
          width: 16,
          height: 16
        }),
        attributes: {
          title: "Virginia Aerial Imagery Service Information for High Impact Areas",
          description: richTextStr
        },
        popupTemplate: new PopupTemplate({
          description: "{description}",
          title: "{title}"
        })
      }),new Graphic({
        geometry: new Point({
          "x": -8572650.077462012,
          "y": 4705500.594466476,
          "spatialReference": {
            "wkid": 102100
          }
        }),
        symbol: new PictureMarkerSymbol({
          url: "https://cdn0.iconfinder.com/data/icons/small-n-flat/24/678111-map-marker-128.png",
          width: 16,
          height: 16
        }),
        attributes: {
          title: "House Office Buildings",
          description: houseBuildingText
        },
        popupTemplate: new PopupTemplate({
          description: "{description}",
          title: "{title}"
        })
      }),new Graphic({
        geometry: new Point({
          "x": -8572700.077462012,
          "y": 4705500.594466476,
          "spatialReference": {
            "wkid": 102100
          }
        }),
        symbol: new PictureMarkerSymbol({
          url: "https://cdn0.iconfinder.com/data/icons/small-n-flat/24/678111-map-marker-128.png",
          width: 16,
          height: 16
        }),
        attributes: {
          title: "Protected Area [no desc.]"
        },
        popupTemplate: new PopupTemplate({
          title: "{title}"
        })
      }), new Graphic({
        geometry: new Point({
          "x": -8572750.077462012,
          "y": 4705500.594466476,
          "spatialReference": {
            "wkid": 102100
          }
        }),
        symbol: new PictureMarkerSymbol({
          url: "https://cdn0.iconfinder.com/data/icons/small-n-flat/24/678111-map-marker-128.png",
          width: 16,
          height: 16
        }),
        attributes: {
          description: '<h1>No Title</h1>'+richTextStr
        },
        popupTemplate: new PopupTemplate({
          description: "{description}",
          title: "{title}"
        })
      }), new Graphic({
        geometry: new Point({
          "x": -8572850.077462012,
          "y": 4705500.594466476,
          "spatialReference": {
            "wkid": 102100
          }
        }),
        symbol: new PictureMarkerSymbol({
          url: "https://cdn0.iconfinder.com/data/icons/small-n-flat/24/678111-map-marker-128.png",
          width: 16,
          height: 16
        }),
        attributes: {
          title: "Category Inspections OKC",
          description: tableDataStr
        },
        popupTemplate: new PopupTemplate({
          description: "{description}",
          title: "{title}"
        })
      })];

      popup.set("features", features);

      popup.set("visible", true);


      view.on("click", function (evt) {

        var features = [new Graphic({
          geometry: evt.mapPoint,
          attributes: {
            title: "U.S. Capitol",
            description: capitolText
          },
          symbol: new PictureMarkerSymbol({
            url: "https://cdn0.iconfinder.com/data/icons/small-n-flat/24/678111-map-marker-128.png",
            width: 16,
            height: 16
          }),
          popupTemplate: new PopupTemplate({
            description: "{description}",
            title: "{title}"
          })
        }), new Graphic({
          geometry: new Point({
            "x": -8572667.077462012,
            "y": 4705830.594466476,
            "spatialReference": {
              "wkid": 102100
            }
          }),
          attributes: {
            title: "U.S. Capitol Lawn",
            description: capitolText
          },
          symbol: new PictureMarkerSymbol({
            url: "https://cdn0.iconfinder.com/data/icons/small-n-flat/24/678111-map-marker-128.png",
            width: 16,
            height: 16
          }),
          popupTemplate: new PopupTemplate({
            description: "{description}",
            title: "{title}"
          })
        }), new Graphic({
          geometry: new Point({
            "x": -8576667.077462012,
            "y": 4705330.594466476,
            "spatialReference": {
              "wkid": 102100
            }
          }),
          attributes: {
            title: "Unsanctioned Testing Facility",
            description: tableDataStr
          },
          symbol: new PictureMarkerSymbol({
            url: "https://cdn0.iconfinder.com/data/icons/small-n-flat/24/678111-map-marker-128.png",
            width: 16,
            height: 16
          }),
          popupTemplate: new PopupTemplate({
            description: "{description}",
            title: "{title}"
          })
        })];
        popup.set("features", features);
        popup.set("visible", true);

      });

      var position = dom.byId("option_position");
      domAttr.set(position, "value", popup.position);
      on(position, "change", function(){
        popup.set("position", position.value);
      });
      popup.watch("position", function(){
        domAttr.set(position, "value", popup.position);
      });

      var visible = dom.byId("option_visible");
      domAttr.set(visible, "checked", popup.visible);
      on(visible, "change", function(evt){
        popup.set("visible", domAttr.get(visible, "checked"));
      });
      popup.watch("visible", function(){
        domAttr.set(visible, "checked", popup.visible);
      });

      var pagination = dom.byId("option_pagination");
      domAttr.set(pagination, "checked", popup.pagination);
      on(pagination, "change", function(evt){
        popup.set("pagination", domAttr.get(pagination, "checked"));
      });
      popup.watch("pagination", function(){
        domAttr.set(pagination, "checked", popup.pagination);
      });

      var expanded = dom.byId("option_expanded");
      domAttr.set(expanded, "checked", popup.expanded);
      on(expanded, "change", function(evt){
        popup.set("expanded", domAttr.get(expanded, "checked"));
      });
      popup.watch("expanded", function(){
        domAttr.set(expanded, "checked", popup.expanded);
      });


      /*var padding = dom.byId("option_padding");
      domAttr.set(padding, "value", popup.padding);
      on(padding, "change", function(){
        popup.set("padding", parseInt(padding.value, 10));
      });
      popup.watch("padding", function(){
        domAttr.set(padding, "value", popup.padding);
      });*/

      var zoomFactor = dom.byId("option_zoomFactor");
      domAttr.set(zoomFactor, "value", popup.zoomFactor);
      on(zoomFactor, "change", function(){
        popup.set("zoomFactor", parseInt(zoomFactor.value, 10));
      });
      popup.watch("zoomFactor", function(){
        domAttr.set(zoomFactor, "value", popup.zoomFactor);
      });

      var selectedIndex = dom.byId("option_selectedIndex");
      domAttr.set(selectedIndex, "value", popup.selectedIndex);
      on(selectedIndex, "change", function(){
        popup.set("selectedIndex", parseInt(selectedIndex.value, 10));
      });
      popup.watch("selectedIndex", function(){
        domAttr.set(selectedIndex, "value", popup.selectedIndex);
      });


    });
  </script>
</head>

<body>
  <div class="drawer-container">
    <div class="drawer-side drawer-animation">
      <h1>Options</h1>
      <ul class="options">
        <li><label><input id="option_visible" type="checkbox" /> Visible</label></li>
        <li><label><input id="option_pagination" type="checkbox" /> Pagination</label></li>
        <li><label><input id="option_expanded" type="checkbox" /> Expanded</label></li>
        <li>
          <label>Position </label>
          <select id="option_position">
            <option value="top">top</option>
            <option value="bottom">bottom</option>
            <option value="left">left</option>
            <option value="right">right</option>
          </select>
        </li>
        <!-- <li>
          <label>Padding </label>
          <input id="option_padding" type="text" value="10" />
        </li> -->
        <li>
          <label>Zoom Factor </label>
          <input id="option_zoomFactor" type="text" value="4" />
        </li>
        <li>
          <label>Selected Index </label>
          <input id="option_selectedIndex" type="text" value="10" />
        </li>
      </ul>
    </div>
    <div class="drawer-center">
      <div class="drawer-top drawer-animation">
        <div id="toggle" class="toggle">
          <span class="esri-icon-expand"></span>
          <span class="esri-icon-collapse"></span>
          <span>Options</span>
        </div>
      </div>
      <div id="mapDiv" dir="ltr">
      </div>
    </div>
  </div>

  <script>



  var tableDataStr = '<table><tr class="odd"><td class="name">Request ID</td><td class="value">471458</td></tr><tr class="even"><td class="name">Request Type</td><td class="value">Maintenance</td></tr><tr class="odd"><td class="name">Request_Date_of_Inspection_To_Be_Performed</td><td class="value">07-19-2009</td></tr><tr class="even"><td class="name">Request Time</td><td class="value">21:58</td></tr><tr class="odd"><td class="name">Request Address</td><td class="value">19 AVE and CLEMET ST</td></tr><tr class="even"><td class="name">X Coordinate</td><td class="value">5989953.0</td></tr><tr class="odd"><td class="name">Y Coordinate</td><td class="value">2113361.5</td></tr><tr class="odd"><td class="name">Request ID</td><td class="value">471458</td></tr><tr class="even"><td class="name">Request Type</td><td class="value">Maintenance</td></tr><tr class="odd"><td class="name">Request_Date_of_Inspection_To_Be_Performed</td><td class="value">07-19-2009</td></tr><tr class="even"><td class="name">Request Time</td><td class="value">21:58</td></tr><tr class="odd"><td class="name">Request Address</td><td class="value">19 AVE and CLEMET ST</td></tr><tr class="even"><td class="name">X Coordinate</td><td class="value">5989953.0</td></tr><tr class="odd"><td class="name">Y Coordinate</td><td class="value">2113361.5</td></tr></table>';

  var richTextStr = "<figure><img src=\"http://cdn.onlyinyourstate.com/wp-content/uploads/2015/07/ok60-1947-tornado.jpg\" /><figcaption>Oklahoma Cats, circa 1987</figcaption></figure><p>The most deadly tornado to ever strike within the borders of the state of Oklahoma occurred on Wednesday, April 9, 1947 in the <a href=\"#\">City of Woodward</a>.</p><p>The Woodward tornadic supercell thunderstorm began in the Texas Panhandle during the afternoon of April 9, 1947, and produced at least six tornadoes along a 220-mile path that stretched from White Deer, TX (northeast of Amarillo) to St. Leo, KS (west of Wichita).</p><p>Here is a list:</p><ul><li>Crescent Heights</li><li>Campus Road</li><li>Practical Praries</li></ul><h2>The Woodward Tornado</h2><p>What is known is that the violent tornado that struck Woodward had a confirmed path that started 3 miles northwest of Canadian, TX. </p><p>The tornado moved northeast, and continued on the ground continuously for about 98 miles, before ending in Woods County, Oklahoma about 10 miles west of Alva. The tornado was massive, up to 1.8 miles wide, and traveled at forward speeds of about 50 miles per hour. It first struck Glazier and Higgins in the Texas Panhandle, devastating both towns and producing at least 69 fatalities in Texas before crossing into Oklahoma.</p><p>In Ellis County, Oklahoma, the tornado did not strike any towns, passing to the southeast of Shattuck, Gage, and Fargo. Even though no towns were struck, nearly 60 farms and ranches were destroyed and 8 people were killed with 42 more injured. Moving into Woodward County, one death was reported near Tangier.</p>";

  var capitolText ='<figure><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4f/US_Capitol_west_side.JPG/240px-US_Capitol_west_side.JPG"></img></figure><p>The <b>United States Capitol</b> is the seat of the <a href="/wiki/United_States_Congress" title="United States Congress">United States Congress</a>, the legislative branch of the <a href="/wiki/Federal_government_of_the_United_States" title="Federal government of the United States">U.S. federal government</a>. It sits atop <a href="/wiki/Capitol_Hill" title="Capitol Hill">Capitol Hill</a>, at the eastern end of the <a href="/wiki/National_Mall" title="National Mall">National Mall</a> in <a href="/wiki/Washington,_D.C." title="Washington, D.C.">Washington, D.C.</a>. Though not at the geographic center of the <a href="/wiki/Geography_of_Washington,_D.C." title="Geography of Washington, D.C.">Federal District</a>, the Capitol forms the origin point for the District\'s street-numbering system and <a href="/wiki/Quadrants_of_Washington,_D.C." title="Quadrants of Washington, D.C.">the District\'s four quadrants</a>.</p><p>The original building was completed in the year 1800 and was subsequently expanded, particularly with the addition of the massive <a href="/wiki/United_States_Capitol_dome" title="United States Capitol dome">dome</a>. Like the principal buildings of the executive and judicial branches, the Capitol is built in a distinctive <a href="/wiki/Neoclassical_architecture" title="Neoclassical architecture">neoclassical style</a> and has a white exterior. Both its east and west elevations are formally referred to as <i>fronts</i>, though only the east front was intended for the reception of visitors and dignitaries.</p><p>In 2014, scaffolding was erected around the dome for a restoration project scheduled to be completed by early 2017.</p>';
  var houseBuildingText = '<figure><img src="http://www.aoc.gov/sites/default/files/styles/artwork-node/public/images/buildings/6309632214_a87729ac9f_o.jpg?itok=C_wUtzvv"></img></figure><p>Planning for a second office building for the House of Representatives began in 1925. Severe overcrowding in the <a href="/capitol-buildings/cannon-house-office-building" title="Cannon House Office Building">Cannon House Office Building</a> (completed in 1908) led to the renovation of the Cannon Building and the construction of the <a href="/house/longworth">Longworth Building</a>. Under the direction of Architect of the Capitol <a href="/architect-of-the-capitol/david-lynn" title="David Lynn ">David Lynn</a>, preliminary designs for the building were prepared by a local firm known as The Allied Architects of Washington (Inc.). The principal architects were Frank Upman, Gilbert LaCoste Rodier, Nathan C. Wyeth and Louis Justemente. They produced two schemes for a simple, dignified building in harmony with the rest of the Capitol Complex. In January 1929, Congress authorized $8,400,000 for acquiring and clearing the site and for constructing the new building. The foundations were completed in December 1930, and the building was accepted for occupancy in April 1933.</p>';
  </script>
</body>

</html>