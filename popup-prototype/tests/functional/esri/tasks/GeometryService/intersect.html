
<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title>IdentifyTask</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no">

  <link rel="stylesheet" href="../../../../../esri/css/main.css">

  <script>
    var dojoConfig = {
      async: true,
      isDebug: true,

      paths: {
        esri: "../esri"
      }
    };
  </script>

  <style>
    html, body {
      padding: 0;
      margin: 0;
    }
  </style>


  <script type="text/javascript" src="../../../../../dojo/dojo.js"></script>
  <script>
    var map, view, identifyParams;

    require([
        "esri/Map",
        "esri/views/MapView",
        "esri/layers/GraphicsLayer",

        "esri/Graphic",
        "esri/geometry/Polyline",
        "esri/geometry/Polygon",

        "esri/symbols/SimpleLineSymbol",
        "esri/symbols/SimpleFillSymbol",

        "esri/geometry/SpatialReference",

        'esri/tasks/GeometryService',

        "dojo/domReady!"
      ],
      function(
        Map, MapView, GraphicsLayer,
        Graphic, Polyline, Polygon,
        SimpleLineSymbol, SimpleFillSymbol,
        SpatialReference,
        GeometryService
      ) {

        map = new Map({
          basemap: "topo"
        });

        view = new MapView({
          container: "viewDiv",
          map: map,
          center: [-145.19682693481445, 40.06020952545651],
          zoom: 6
        });

        view.then(
          function() {
            var graphicsLayer = new GraphicsLayer();
            map.add(graphicsLayer);

            var polygon1 = new Polygon([
              [-140.20061978149414, 37.06001021532272],
              [-145.19682693481445, 44.06020952545651],
              [-140.20082693482441, 40.05828952743655]
            ], new SpatialReference({wkid:4326}));

            var fillSymbol = new SimpleFillSymbol({
              color: "red",

              outline: new SimpleLineSymbol({
                color: [255, 255, 255],
                width: 1
              })
            });

            var polygonGraphic1 = new Graphic({
              geometry: polygon1,
              symbol: fillSymbol
            });

            graphicsLayer.add(polygonGraphic1);

            var polygon2 = new Polygon([
              [-145.20061978149414, 37.06001021532272],
              [-140.19682693481445, 44.06020952545651],
              [-145.20082693482441, 40.05828952743655]
            ], new SpatialReference({wkid:4326}));

            var fillSymbol = new SimpleFillSymbol({
              color: "green",

              outline: new SimpleLineSymbol({
                color: [255, 255, 255],
                width: 1
              })
            });

            var polygonGraphic2 = new Graphic({
              geometry: polygon2,
              symbol: fillSymbol
            });

            graphicsLayer.add(polygonGraphic2);

            var geometryService = new GeometryService("http://sampleserver6.arcgisonline.com/arcgis/rest/services/Utilities/Geometry/GeometryServer");
            geometryService.intersect([polygon1], polygon2).then(
              function(result) {
                console.log(result);

                var fillSymbol = new SimpleFillSymbol({
                  color: "yellow",

                  outline: new SimpleLineSymbol({
                    color: [255, 255, 255],
                    width: 1
                  })
                });

                polylineGraphic = new Graphic({
                  geometry: result[0],
                  symbol: fillSymbol
                });

                graphicsLayer.add(polylineGraphic);


              }
            );
          }
        );


      });
  </script>
</head>

<body>
<div id="viewDiv"></div>
</body>

</html>
