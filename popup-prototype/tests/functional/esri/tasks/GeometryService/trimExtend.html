
<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title>IdentifyTask</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no">

  <link rel="stylesheet" href="../../../../../esri/css/main.css">

  <script>
    var dojoConfig = {
      async: true,
      isDebug: true,

      paths: {
        esri: "../esri"
      }
    };
  </script>

  <style>
    html, body {
      padding: 0;
      margin: 0;
    }
  </style>


  <script type="text/javascript" src="../../../../../dojo/dojo.js"></script>
  <script>
    var map, view, identifyParams;

    require([
        "esri/Map",
        "esri/views/MapView",
        "esri/layers/GraphicsLayer",

        "esri/Graphic",
        "esri/geometry/Polyline",
        "esri/geometry/Polygon",

        "esri/symbols/SimpleLineSymbol",
        "esri/symbols/SimpleFillSymbol",

        "esri/geometry/SpatialReference",

        'esri/tasks/GeometryService',
        "esri/tasks/support/TrimExtendParameters",

        "dojo/domReady!"
      ],
      function(
        Map, MapView, GraphicsLayer,
        Graphic, Polyline, Polygon,
        SimpleLineSymbol, SimpleFillSymbol,
        SpatialReference,
        GeometryService, TrimExtendParameters
      ) {

        map = new Map({
          basemap: "topo"
        });

        view = new MapView({
          container: "viewDiv",
          map: map,
          center: [-145.19682693481445, 40.06020952545651],
          zoom: 6
        });

        view.then(
          function() {
            var graphicsLayer = new GraphicsLayer();
            map.add(graphicsLayer);

            var polyline1 = new Polyline([
              [-145.20061978149414, 37.06001021532272],
              [-140.19682693481445, 44.06020952545651],
              [-145.20082693482441, 40.05828952743655]
            ], new SpatialReference({wkid:4326}));

            var lineSymbol = new SimpleLineSymbol({
              color: "blue",
              width: 4
            });

            var polylineGraphic1 = new Graphic({
              geometry: polyline1,
              symbol: lineSymbol
            });

            graphicsLayer.add(polylineGraphic1);

            var polyline2 = new Polyline([
              [-141.20061978149414, 37.06001021532272],
              [-146.19682693481445, 44.06020952545651]
            ], new SpatialReference({wkid:4326}));

            var lineSymbol = new SimpleLineSymbol({
              color: "blue",
              width: 4
            });

            var polylineGraphic2 = new Graphic({
              geometry: polyline2,
              symbol: lineSymbol
            });

            graphicsLayer.add(polylineGraphic2);

           var polyline3 = new Polyline([
              [-135.20061978149414, 46.06001021532272],
              [-145.19682693481445, 44.06020952545651],
              [-140.20082693482441, 40.05828952743655]
            ], new SpatialReference({wkid:4326}));

            var lineSymbol = new SimpleLineSymbol({
              color: "blue",
              width: 4
            });

            var polylineGraphic3 = new Graphic({
              geometry: polyline3,
              symbol: lineSymbol
            });

            graphicsLayer.add(polylineGraphic3);

            var params = new TrimExtendParameters();
            params.extendHow = 1;
            params.polylines = [polyline2, polyline1];
            params.trimExtendTo = polyline3;


            var geometryService = new GeometryService("http://sampleserver6.arcgisonline.com/arcgis/rest/services/Utilities/Geometry/GeometryServer");
            geometryService.trimExtend(params).then(
              function(result) {
                console.log(result);

                result.forEach(function(res){
                  var lineSymbol = new SimpleLineSymbol({
                    color: "yellow",
                    width: 4
                  });

                  polylineGraphic = new Graphic({
                    geometry: res,
                    symbol: lineSymbol
                  });

                  graphicsLayer.add(polylineGraphic);
                })


              }
            );
          }
        );


      });
  </script>
</head>

<body>
<div id="viewDiv"></div>
</body>

</html>
