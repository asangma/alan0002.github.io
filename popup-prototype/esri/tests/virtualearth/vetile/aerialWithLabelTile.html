<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>onLoad</title>

    <link rel="stylesheet" type="text/css" href="../../../../dojo/dijit/themes/tundra/tundra.css">
      <script>
          dojoConfig = {
              isDebug: true
          };
      </script>
      <script type="text/javascript" src="../../../../../index.jsp">
      </script>

    <script type="text/javascript">
      dojo.require("esri.map");
	  dojo.require("esri.virtualearth.VETiledLayer");
      dojo.require("doh.runner");
	  var map;
	  
      function init() {
        
        map = new esri.Map("map");
       
        //Creates the Virtual Earth layer to add to the map
        veTileLayer = new esri.virtualearth.VETiledLayer({
          bingMapsKey:'AmYgFHxR1J5GOgv_0a0eVtcWabmvg1R1WHueiUH7w3f7DAWJlv1ChftrlVPzssLI',
		  mapStyle:esri.virtualearth.VETiledLayer.MAP_STYLE_AERIAL_WITH_LABELS
         });
		
        dojo.connect(map, "onLayerAdd", runTests);
        map.addLayer(veTileLayer);

         
        
      }

      function runTests(t) {
        doh.registerGroup("virtualearth.aerialWithLabelTile", [
          {
            name: "aerialWithLabelTile",
            timeout: 3000,
            runTest: function(t) {
			  var d = new doh.Deferred();
              	
				var vetiledLayer = map.getLayer("layer0");
				console.log(vetiledLayer);
				
				t.assertEqual("aerialWithLabels",vetiledLayer.mapStyle)
				d.callback(true);
              return d;
            }
          }
        ]);
        doh.run();
      }
      
      dojo.addOnLoad(init);
    </script>

  </head>
  <body class="tundra">
    <div id="map" style="width:1024px; height:512px; border:1px solid #000;"></div>
  </body>
</html>
