<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>onLoad</title>

    <link rel="stylesheet" type="text/css" href="../../../../dojo/dijit/themes/tundra/tundra.css">
      <script>
          dojoConfig = {
              isDebug: true
          };
      </script>
      <script type="text/javascript" src="../../../../../index.jsp">
      </script>

    <script type="text/javascript">
      dojo.require("esri.map");
      dojo.require("doh.runner");
	  
	  var map,basemap,graphicsLayer;
	  var attributes = {"NAME" : "Douglas",
        			"ObjectID" : 1242,
       				 "STATE_NAME" : "Kansas",
        			 "STATE_FIPS" : "20",
        			 "CNTY_FIPS" : "045",
        			 "FIPS" : "20045",
        			 "POP2000" : 99962,
        			"POP2007" : 107920,
        			"POP00_SQMI" : 210.7,
        			"POP07_SQMI" : 227.5,
        			"WHITE" : 86060,
        			"BLACK" : 4238,
        			"AMERI_ES" : 2561,
        			"ASIAN" : 3119,
        			"HAWN_PI" : 62,
        			"OTHER" : 1197,
        			"MULT_RACE" : 2725,
        			"HISPANIC" : 3268,
        			"MALES" : 49651,
       		 		"FEMALES" : 50311,
        			"AGE_UNDER5" : 5568,
        			"AGE_5_17" : 14833,
        			"AGE_18_21" : 17042,
        			"AGE_22_29" : 17915,
       				"AGE_30_39" : 13265,
        			"AGE_40_49" : 12596,
        			"AGE_50_64" : 10806,
        			"AGE_65_UP" : 7937,
        			"AGE_UNDER5P" : 5.6,
        			"AGE_5_17P" : 14.8,
        			"AGE_18_21P" : 17,
        			"AGE_22_29P" : 17,
        			"AGE_30_39P" : 13.3,
        			"AGE_40_49P" : 12.6,
        			"AGE_50_64P" : 10.8,
        			"AGE_65_UPP" : 7.9,
        			"MED_AGE" : 26.6,
        			"MED_AGE_M" : 26.1,
        			"MED_AGE_F" : 27.3,
        			"HOUSEHOLDS" : 38486,
        			"AVE_HH_SZ" : 2.37,
        			"HSEHLD_1_M" : 5185,
        			"HSEHLD_1_F" : 5795,
        			"MARHH_CHD" : 7673,
        			"MARHH_NO_C" : 8917,
        			"MHH_CHILD" : 701,
        			"FHH_CHILD" : 2170,
        			"FAMILIES" : 21159,
        			"AVE_FAM_SZ" : 2.97,
        			"HSE_UNITS" : 40250,
        			"VACANT" : 1764,
        			"OWNER_OCC" : 19975,
        			"RENTER_OCC" : 18511,
        			"NO_FARMS97" : 839,
        			"AVG_SIZE97" : 260,
        			"CROP_ACR97" : 146918,
        			"AVG_SALE97" : 46.35,
        			"SQMI" : 474.4,
        			"Shape_Length" : 1.53853402891229,
        			"Shape_Area" : 0.12913459051245
      };
	 
	  
       function init(){
	   	var extent = new esri.geometry.Extent(-116, -40, 59, 65, new esri.SpatialReference({
	   		wkid: 4326
	   	}));
	   	map = new esri.Map("map", {
	   		extent: extent
	   	});
	   	dojo.connect(map, "onLoad", runTests);
	   	
	   	basemap = new esri.layers.ArcGISTiledMapServiceLayer("http://server.arcgisonline.com/ArcGIS/rest/services/NGS_Topo_US_2D/MapServer");
	  	map.addLayer(basemap);
				
	   }
		
	   
				
      function runTests() {
        doh.registerGroup("graphic.multipoint.property", [
          {
            name: "symbol",
            timeout: 3000,
            runTest: function(t) {
				
				dojo.connect(basemap,"onUpdate",addMultiPointGraphic);
				
				var d = new doh.Deferred();			
			    function assert(graphic) {
					console.debug(graphic.symbol.type);
					console.debug(graphic.symbol.color);
					
					
					
                	t.assertEqual("simplemarkersymbol", graphic.symbol.type);
					t.assertEqual("0", graphic.symbol.color.r);
					t.assertEqual("0", graphic.symbol.color.g);
					t.assertEqual("255", graphic.symbol.color.b);
					
					
					
                	d.callback(true);
              	}
				
              function addMultiPointGraphic() {
	   				
					var multipoint = new esri.geometry.Multipoint(map.spatialReference);
        			multipoint.addPoint([-80,40]);
        			multipoint.addPoint([-80,30]);
        			multipoint.addPoint([-80,20]);
        			var pointSymbol = new esri.symbol.SimpleMarkerSymbol().setColor(new dojo.Color("blue"));
        			var content = "<B>${NAME}, ${STATE_NAME}</B><br />";
        			var infoTemplate = new esri.InfoTemplate("MultiPoint Graphic Test",content);
        			var graphic = new esri.Graphic(multipoint,pointSymbol,attributes,infoTemplate);
        
					graphicsLayer = map.graphics;
        			dojo.connect(graphicsLayer,"onGraphicAdd",assert);
					graphicsLayer.add(graphic);
	
      		}
              return d; 
            }
			
          
          }
        ]);
		
        doh.run();
      }
     
      dojo.addOnLoad(init);
    </script>

  </head>
  <body class="tundra">
    <div id="map" style="width:1024px; height:512px; border:1px solid #000;"></div>
  </body>
</html>
