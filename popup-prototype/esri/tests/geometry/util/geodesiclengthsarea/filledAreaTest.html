<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <meta name="generator" content="HTML Tidy, see www.w3.org">
        <meta http-equiv="Content-Type" content= "text/html; charset=utf-8">
        <title>Query Features</title>
        <link rel="stylesheet" type="text/css" href= "../../../../../dojo/dijit/themes/tundra/tundra.css">
        <script>
            dojoConfig = {
                isDebug: true
            };
        </script>
        <script type="text/javascript" src="../../../../../../index.jsp">
        </script>
        <script type="text/javascript">
            dojo.require("esri.geometry");
            dojo.require("esri.map");
            dojo.require("doh.runner");
            
            
            var clockwisePolygon,countClockwisePolygon,filledPolygon;
            
            function init(){
            
                var map = new esri.Map("mapDiv");
                dojo.connect(map, "onLoad", runTests);
                var layer = new esri.layers.ArcGISDynamicMapServiceLayer("http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Specialty/ESRI_StatesCitiesRivers_USA/MapServer");
                map.addLayer(layer);
                
                var clockwiseRing = [[[-111.81843309925785, 44.05359028891994], [-97.56568075942923, 43.93381926085416], [-97.9249938436266, 30.040380005222907], [-112.17774618345521, 32.19625851040707], [-111.81843309925785, 44.05359028891994], [-111.81843309925785, 44.05359028891994]]];
                var countClockwiseRing = [[[-101.75766674173178, 40.34068841888056], [-108.34507328535004, 40.460459446946345], [-107.50667608888953, 33.15442673493336], [-99.84133029267919, 33.274197762999144], [-101.99720879786335, 40.58023047501213], [-101.75766674173178, 40.34068841888056]]];
                clockwisePolygon = new esri.geometry.Polygon(new esri.SpatialReference({
                    wkid: 4326
                }));
                clockwisePolygon.addRing(clockwiseRing[0]);
                countClockwisePolygon = new esri.geometry.Polygon(new esri.SpatialReference({
                    wkid: 4326
                }));
                countClockwisePolygon.addRing(countClockwiseRing[0]);
				filledPolygon = new esri.geometry.Polygon(new esri.SpatialReference({
                            wkid: 4326
                        }));
                filledPolygon.addRing(clockwiseRing[0]);
                filledPolygon.addRing(countClockwiseRing[0]);
                
                
            }
            
            function runTests(){
            
            
                doh.registerGroup("geometry.util.geodesiclengthsarea.filledAreaTest", [{
                    name: "filledAreas_ACRES ",
                    timeout: 3000,
                    runTest: function(t){
                    
                        
                        var clockwiseArea = esri.geometry.geodesicAreas([clockwisePolygon], esri.Units.ACRES);
						
                        var countClockwiseArea = esri.geometry.geodesicAreas([countClockwisePolygon], esri.Units.ACRES);
                        var filledAreas = esri.geometry.geodesicAreas([filledPolygon], esri.Units.ACRES);
                     	var substractedAreas = Math.abs(clockwiseArea[0]-Math.abs(countClockwiseArea[0]));
						var diff = Math.abs(Math.abs(filledAreas[0]) - substractedAreas)/substractedAreas* 100;
                        console.log(diff);
						if (diff < 0.02) {
                             t.assertTrue(true);
                        }
                        
                        
                    }
                    
                    
                }, 
				{
                    name: "filledAreas_SQUARE_KILOMETERS",
                    timeout: 3000,
                    runTest: function(t){
                    
                        
                        var clockwiseArea = esri.geometry.geodesicAreas([clockwisePolygon], esri.Units.SQUARE_KILOMETERS);
						
                        var countClockwiseArea = esri.geometry.geodesicAreas([countClockwisePolygon], esri.Units.SQUARE_KILOMETERS);
                        var filledAreas = esri.geometry.geodesicAreas([filledPolygon], esri.Units.SQUARE_KILOMETERS);
                     	var substractedAreas = Math.abs(clockwiseArea[0]-Math.abs(countClockwiseArea[0]));
						var diff = Math.abs(Math.abs(filledAreas[0]) - substractedAreas)/substractedAreas* 100;
                        console.log(diff);
						if (diff < 0.02) {
                           t.assertTrue(true);
                        }
                        
                        
                    }
                    
                    
                },
				{
                    name: "filledAreas_SQUARE_MILES",
                    timeout: 3000,
                    runTest: function(t){
                    
                        
                        var clockwiseArea = esri.geometry.geodesicAreas([clockwisePolygon], esri.Units.SQUARE_MILES);
					    var countClockwiseArea = esri.geometry.geodesicAreas([countClockwisePolygon], esri.Units.SQUARE_MILES);
                        var filledAreas = esri.geometry.geodesicAreas([filledPolygon], esri.Units.SQUARE_MILES);
                     	var substractedAreas = Math.abs(clockwiseArea[0]-Math.abs(countClockwiseArea[0]));
						var diff = Math.abs(Math.abs(filledAreas[0]) - substractedAreas)/substractedAreas* 100;
                        console.log(diff);
						if (diff < 0.02) {
                            t.assertTrue(true);
                        }
                        
                        
                    }
                    
                    
                },]);
                
                
                doh.run();
            }
            
            dojo.addOnLoad(init);
        </script>
    </head>
    <body class="tundra">
        <div id="mapDiv" style="width:900px; height:600px; border:1px solid #000;">
        </div>
    </body>
</html>
