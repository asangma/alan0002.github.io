<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <meta name="generator" content="HTML Tidy, see www.w3.org">
        <meta http-equiv="Content-Type" content= "text/html; charset=utf-8">
        <title>Query Features</title>
        <link rel="stylesheet" type="text/css" href= "../../../../dojo/dijit/themes/tundra/tundra.css">
        <script>
            dojoConfig = {
                isDebug: true
            };
        </script>
        <script type="text/javascript" src="../../../../../index.jsp">
        </script>
        <script type="text/javascript">
            dojo.require("esri.geometry");
            dojo.require("esri.map");
            dojo.require("doh.runner");
            
            
            var map;
            
            function init(){
            
                map = new esri.Map("mapDiv");
                dojo.connect(map, "onLoad", runTests);
                var layer = new esri.layers.ArcGISDynamicMapServiceLayer("http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Specialty/ESRI_StatesCitiesRivers_USA/MapServer");
                map.addLayer(layer);
                
                
            }
            
            function runTests(){
            
            
                doh.registerGroup("geometry.namespace.toMapGeometryTest", [{
                    name: "testExtent",
                    timeout: 3000,
                    runTest: function(t){
                        var extentJson = {
                            "xmin": -109.55,
                            "ymin": 25.76,
                            "xmax": -86.39,
                            "ymax": 49.94,
                            "spatialReference": {
                                "wkid": 4326
                            }
                        };
                        
                        var geometry = esri.geometry.fromJson(extentJson);
                        var mapExtentJson = {
                            "xmin": -125.55,
                            "ymin": 19.76,
                            "xmax": -66.39,
                            "ymax": 49.94,
                            "spatialReference": {
                                "wkid": 4326
                            }
                        
                        }
                        var geometry = esri.geometry.toMapGeometry(new esri.geometry.Extent(mapExtentJson), 900, 600, geometry);
                        t.assertEqual(geometry.type, "extent");
                        
                    }
                }, {
                    name: "testMultipoint",
                    timeout: 3000,
                    runTest: function(t){
                    
                        var multipointJson = {
                            "points": [[-97.06138, 32.837], [-97.06133, 32.836], [-97.06124, 32.834], [-97.06127, 32.832]],
                            "spatialReference": {
                                "wkid": 4326
                            }
                        };
                        
                        var geometry = esri.geometry.fromJson(multipointJson);
                        var mapExtentJson = {
                            "xmin": -125.55,
                            "ymin": 19.76,
                            "xmax": -66.39,
                            "ymax": 49.94,
                            "spatialReference": {
                                "wkid": 4326
                            }
                        
                        }
                        var geometry = esri.geometry.toMapGeometry(new esri.geometry.Extent(mapExtentJson), 900, 600, geometry);
                        t.assertEqual(geometry.type, "multipoint");
                        
                    }
                }, {
                    name: "testPoint",
                    timeout: 3000,
                    runTest: function(t){
                        var pointJson = {
                            "x": -118.15,
                            "y": 33.80,
                            "spatialReference": {
                                "wkid": 4326
                            }
                        };
                        
                        var geometry = esri.geometry.fromJson(pointJson);
                        var mapExtentJson = {
                            "xmin": -125.55,
                            "ymin": 19.76,
                            "xmax": -66.39,
                            "ymax": 49.94,
                            "spatialReference": {
                                "wkid": 4326
                            }
                        
                        }
                        var geometry = esri.geometry.toMapGeometry(new esri.geometry.Extent(mapExtentJson), 900, 600, geometry);
                        t.assertEqual(geometry.type, "point");
                        
                    }
                }, {
                    name: "testPolylineSinglePath",
                    timeout: 3000,
                    runTest: function(t){
                        var polylineJson = {
                            "paths": [[[-97.06138, 32.837], [-97.06133, 32.836], [-97.06124, 32.834], [-97.06127, 32.832]]],
                            "spatialReference": {
                                "wkid": 4326
                            }
                        };
                        
                        var geometry = esri.geometry.fromJson(polylineJson);
                        var mapExtentJson = {
                            "xmin": -125.55,
                            "ymin": 19.76,
                            "xmax": -66.39,
                            "ymax": 49.94,
                            "spatialReference": {
                                "wkid": 4326
                            }
                        
                        }
                        var geometry = esri.geometry.toMapGeometry(new esri.geometry.Extent(mapExtentJson), 900, 600, geometry);
                        t.assertEqual(geometry.type, "polyline");
                        
                    }
                }, {
                    name: "testPolylineMultiPath",
                    timeout: 3000,
                    runTest: function(t){
                        var polylineJson = {
                            "paths": [[[-97.06138, 32.837], [-97.06133, 32.836], [-97.06124, 32.834], [-97.06127, 32.832]], [[-97.06326, 32.759], [-97.06298, 32.755]]],
                            "spatialReference": {
                                "wkid": 4326
                            }
                        };
                        
                        var geometry = esri.geometry.fromJson(polylineJson);
                        var mapExtentJson = {
                            "xmin": -125.55,
                            "ymin": 19.76,
                            "xmax": -66.39,
                            "ymax": 49.94,
                            "spatialReference": {
                                "wkid": 4326
                            }
                        
                        }
                        var geometry = esri.geometry.toMapGeometry(new esri.geometry.Extent(mapExtentJson), 900, 600, geometry);
                        t.assertEqual(geometry.type, "polyline");
                        
                    }
                }, {
                    name: "testPolygonSingleRing",
                    timeout: 3000,
                    runTest: function(t){
                        var polygonJson = {
                            "rings": [[[-97.06138, 32.837], [-97.06133, 32.836], [-97.06124, 32.834], [-97.06127, 32.832], [-97.06138, 32.837]]],
                            "spatialReference": {
                                "wkid": 4326
                            }
                        
                        };
                        
                        
                        var geometry = esri.geometry.fromJson(polygonJson);
                        var mapExtentJson = {
                            "xmin": -125.55,
                            "ymin": 19.76,
                            "xmax": -66.39,
                            "ymax": 49.94,
                            "spatialReference": {
                                "wkid": 4326
                            }
                        
                        }
                        var geometry = esri.geometry.toMapGeometry(new esri.geometry.Extent(mapExtentJson), 900, 600, geometry);
                        t.assertEqual(geometry.type, "polygon");
                        
                    }
                }, {
                    name: "testPolygonMultiRing",
                    timeout: 3000,
                    runTest: function(t){
                        var polygonJson = {
                            "rings": [[[-97.06138, 32.837], [-97.06133, 32.836], [-97.06124, 32.834], [-97.06127, 32.832], [-97.06138, 32.837]], [[-97.06326, 32.759], [-97.06298, 32.755], [-97.06153, 32.749], [-97.06326, 32.759]]],
                            "spatialReference": {
                                "wkid": 4326
                            }
                        
                        };
                        
                        var geometry = esri.geometry.fromJson(polygonJson);
                        var mapExtentJson = {
                            "xmin": -125.55,
                            "ymin": 19.76,
                            "xmax": -66.39,
                            "ymax": 49.94,
                            "spatialReference": {
                                "wkid": 4326
                            }
                        
                        }
                        var geometry = esri.geometry.toMapGeometry(new esri.geometry.Extent(mapExtentJson), 900, 600, geometry);
                        t.assertEqual(geometry.type, "polygon");
                        
                    }
                }]);
                
                
                doh.run();
            }
            
            dojo.addOnLoad(init);
        </script>
    </head>
    <body class="tundra">
        <div id="mapDiv" style="width:900px; height:600px; border:1px solid #000;">
        </div>
    </body>
</html>
