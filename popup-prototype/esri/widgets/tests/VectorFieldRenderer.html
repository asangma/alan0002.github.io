<!DOCTYPE html>
<html>
  <head>
    <title>VectorFieldRenderer Test</title>
    <style>
      html, body, #map
      {
        height: 100%;
        width: 100%;
        margin: 0;
        padding: 0;
        overflow: hidden;
      }

      #vfrContainer
      {
        position: absolute;
        top: 10px;
        right: 10px;
        height: 700px;
        width: 300px;
        display: block;
        border: 2px solid #AFAFAF;
        border-radius: 25px;
        background-color: #EEEEEE;
        padding: 10px;
      }
    </style>
    <link rel="stylesheet" type="text/css" href="../../../dijit/themes/claro/claro.css">
    <link rel="stylesheet" type="text/css" href="../../css/main.css">
    <script type="text/javascript">
      var dojoConfig = {
        parseOnLoad: true,
        isDebug: true,
        async: true,
        packages: [
          {
            name: "esri",
            location: "../esri"
          }
        ]
      };
    </script>
    <script type="text/javascript" src="../../../dojo/dojo.js"></script>
    <script type="text/javascript">
      require(["dojo/parser",
        "esri/map",
        "esri/layers/ArcGISImageServiceVectorLayer",
        "..//VectorFieldRenderer",
        "dojo/domReady!"],
              function (parser, Map, ImageServiceVectorLayer, VectorFieldRenderer) {
                var map = new Map("map", {
                  basemap: "streets",
                  zoom: 3
                });

                function getParameterByName (name) {
                  name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
                  var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
                          results = regex.exec(location.search);
                  return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
                }

                var isUrl = getParameterByName("isUrl");
                isUrl = isUrl ? isUrl : "//wju:6080/arcgis/rest/services/demo/uv/ImageServer";

                var isvLayer = new ImageServiceVectorLayer(isUrl);
                map.addLayer(isvLayer);
                
                isvLayer.on("load", function(){
                  var vfr = new VectorFieldRenderer({
                  layer: isvLayer,
                  map: map,
                  hideApplyButton: false
                }, "vfrContainer");
                
                vfr.startup();
                });
                

              });
    </script>
  </head>
  <body class="claro">
    <div id="map"></div>
    <div style="" id="vfrContainer"></div>
  </body>
</html>
