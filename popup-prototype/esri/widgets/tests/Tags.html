<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title>Tags test</title>

  <link rel="stylesheet" type="text/css" href="../../../dijit/themes/soria/soria.css">
  <link rel="stylesheet" type="text/css" href="../../css/main.css">

  <style>
    .instructions {
      max-width: 500px;
      background-color: beige;
      border: 1px solid #333;
      -webkit-border-radius: 5px;
      -moz-border-radius: 5px;
      border-radius: 5px;
      padding: 0 1em 1em 1em;
    }
    .instructions > ul li {
      margin-top: 0.25em;
      margin-bottom: 0.25em;
    }
    .padded {
      margin-top: 1em;
      margin-bottom: 1em;
      clear: both;
    }
  </style>

  <script type="text/javascript">
    var dojoConfig = {
      parseOnLoad: true,
      isDebug: true,
      packages: [{
        name: "esri",
        location: "../esri"
      }]
    };
  </script>
  <script type="text/javascript" src="../../../dojo/dojo.js"></script>
  <script type="text/javascript">
    require([
      "esri/widgets/Tags",
      "dijit/form/Button",
      "dijit/form/ValidationTextBox",
      "dijit/registry",
      "dojo/dom",
      "dojo/dom-attr",
      "dojo/on",
      "dojo/parser",
      "dojo/domReady!"
    ], function(Tags, ValidationTextBox, Button, registry, dom, domAttr, on, parser) {
      parser.parse();

      var setKnownTagsBtn = registry.byId("set-known-tags-button"),
        clearAllTagsBtn = registry.byId("clear-all-tags-button"),
        setTagsBtn = registry.byId("set-tags-button"),
        clearTagsBtn = registry.byId("clear-tags-button"),
        getTagsBtn = registry.byId("get-tags-button"),
        setFocusBtn = registry.byId("set-focus-button"),
        tags = registry.byId("tags-widget"),
      // AGOL uses the following format for each tag in the list: {"tag": "tagName", "count": 1}
        knownTagList = [
          {"tag": "testing", "count": 2},
          {"tag": "2014", "count": 2},
          {"tag": "data", "count": 1},
          {"tag": "World", "count": 1},
          {"tag": "Gas", "count": 1},
          {"tag": "Electric", "count": 1},
          {"tag": "Europe", "count": 1}
        ],
        tagList = ["NFL","Football","Seahawks"];
      on(setKnownTagsBtn, "click", function() {
        tags.set("knownTags", knownTagList);
      });
      on(clearAllTagsBtn, "click", function() {
        tags.set("knownTags", []);
      });
      on(setTagsBtn, "click", function() {
        tags.set("tags", tagList);
      });
      on(clearTagsBtn, "click", function() {
        tags.set("tags", []);
      });
      on(getTagsBtn, "click", function() {
        var tagList = tags.get("tags");
        domAttr.set(dom.byId("get-tags-output"), "innerHTML", tagList);
      });
      on(setFocusBtn, "click", function() {
        tags.focus();
      });
      // listen to and log tag widget events
      on(tags, "tags-add", function(e) {
        domAttr.set("tag-event-output", "innerHTML", "[tags-add] " + e.tag);
      });
      on(tags, "tags-remove", function(e) {
        domAttr.set("tag-event-output", "innerHTML", "[tags-remove] " + e.tag);
      });
      on(tags, "tags-change", function(e) {
        domAttr.set("tag-event-output", "innerHTML", "[tags-change] " + e.tags);
      });
    });
  </script>
</head>
<body class="soria">
  <h1>Tags Tests</h1>
  <div class="padded instructions">
    <h3>Usage Hints</h3>
    <ul>
      <li>When entering a tag, typing Enter, Tab, or changing focus to another element with the mouse will enter the current string as a tag.</li>
      <li>When entering a tag, typing Backspace when the input is empty will remove the last selected tag in the list.</li>
      <li>Hit the down arrow to open the auto complete drop down without typing other characters.</li>
      <li>Use the up or down arrows to navigate the auto complete list.</li>
      <li>Clicking on a tag in the auto complete drop down list will select that tag and add it to the list of selected tags.</li>
      <li>When in the auto complete drop down list and a tag is selected, typing Enter will select the tag, adding it to the list of selected tags.</li>
      <li>Setting required to true (declaratively via data-dojo-props, or programmatically via set("required", true);) will cause this widget to check that one or more tags are set, and should validate as part of a dijit/form/Form.</li>
    </ul>
    <h3>Events</h3>
    <ul>
      <li>tags-add: Dispatched when a tag is added. The Event object will contain a property named tag which contains the value of the added tag.</li>
      <li>tags-remove: Dispatched when a tag is removed. The Event object will contain a property named tag which contains the value of the removed tag.</li>
      <li>tags-change: Dispatched when tags change. The Event object will contain a property named tags which contains the current tags after the change.</li>
    </ul>
  </div>
  <div class="padded">
    <button id="clear-all-tags-button" data-dojo-type="dijit/form/Button" title="Clears the selected tags as well as the tags from the auto complete drop down">Clear all tags</button>
    <button id="set-known-tags-button" data-dojo-type="dijit/form/Button" title="Sets the tags listed in the auto complete drop down and clears the selected tags">Set known tags</button>
    <button id="set-tags-button" data-dojo-type="dijit/form/Button" title="Sets the tags that are selected in the widget">Set selected tags</button>
    <button id="clear-tags-button" data-dojo-type="dijit/form/Button" title="Clears the selected tags from the widget">Clear selected tags</button>
    <button id="get-tags-button" data-dojo-type="dijit/form/Button" title="Retrieves the selected tags from the widget">Get selected tags</button>
    <button id="set-focus-button" data-dojo-type="dijit/form/Button" title="Sets focus on the tags widget">Set focus</button>
  </div>
  <div class="padded">
    <div id="tags-widget" data-dojo-type="esri/widgets/Tags" data-dojo-props="required:true, minWidth:'500px', maxWidth:'500px'"></div>
  </div>
  <div class="padded">
    <br/>Get tags output: <span id="get-tags-output"></span>
    <br/>Last event: <span id="tag-event-output"></span>
  </div>
</body>
</html>
