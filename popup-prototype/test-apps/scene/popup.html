
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <!--The viewport meta tag is used to improve the presentation and behavior of the samples
      on iOS devices-->
    <meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no">
    <title>Popup</title>

    <style>
      html, body, #map {
        padding: 0;
        margin: 0;
        height: 100%;
      }

      /* Change color of icons to match bar chart and selection symbol */
      .esriPopup.dark div.titleButton,
      .esriPopup.dark div.titlePane .title,
      .esriPopup.dark div.actionsPane .action {
        color: #A4CE67;
      }
      /* Additional customizations */
      .esriPopup.dark .esriPopupWrapper {
        border: none;
      }
      .esriPopup .contentPane {
        text-align: center;
      }
      .esriViewPopup .gallery {
        margin: 0 auto;
      }
    </style>


    <script src="./jsapi.js"></script>
    <link href="../../esri/css/view.css" rel="stylesheet" type="text/css">
    <link href="../../esri/css/main.css" rel="stylesheet" type="text/css">
    <script src="../../dojo/dojo.js"></script>

    <script>
      var map, view;

      jsAPI.setup([
        "esri/Map",
        "esri/views/SceneView",
        "esri/widgets/PopupTemplate",
        "esri/layers/FeatureLayer"
      ], function(
        Map,
        SceneView,
        PopupTemplate,
        FeatureLayer
      ) {

      map = new Map({
        basemap: "gray"
      });

      view = new SceneView({
        container: "map",
        map: map
      });

      var template = new PopupTemplate({
        title: "Boston Marathon 2013",
        description: "{STATE_NAME}:  {Percent_Fi} of starters finished",
        fieldInfos: [{ //define field infos so we can specify an alias
          fieldName: "STATE_NAME",
          label: "State:",
          visible: true
        },{
          fieldName: "Number_Ent",
          label: "Entrants:",
          visible: true
        },{
          fieldName: "Number_Sta",
          label: "Starters:",
          visible: true
        },{
          fieldName: "Number_Fin",
          label: "Finishers:",
          visible: true
        }],
        mediaInfos:[{ //define the bar chart
          caption: "",
          type:"barchart",
          value:{
            theme: "Dollar",
            fields:["Number_Ent","Number_Sta","Number_Fin"]
          }
        }]
      });

      var featureLayer = new FeatureLayer("http://services.arcgis.com/V6ZHFr6zdgNZuVG0/arcgis/rest/services/Boston_Marathon/FeatureServer/0", {
        mode: FeatureLayer.MODE_SNAPSHOT,
        outFields: ["*"],
        popupTemplate: template,
        showLabels: true
      });

      map.add(featureLayer);

      var templateHurricane = new PopupTemplate({
        title: "Hurrican Andrew",
        fieldInfos: [{ //define field infos so we can specify an alias
          fieldName: "Date",
          label: "Date:",
          visible: true
        },{
          fieldName: "CAT",
          label: "Storm Category:",
          visible: true
        },{
          fieldName: "PRESSURE",
          label: "Pressure:",
          visible: true
        },{
          fieldName: "Wind_MPH",
          label: "Wind (mph):",
          visible: true
        }]
      });

      var hurricane = new FeatureLayer("http://services.arcgis.com/nzS0F0zdNLvs7nc8/ArcGIS/rest/services/05_HurricaneAndrew_1992/FeatureServer/0", {
        mode: FeatureLayer.MODE_SNAPSHOT,
        outFields: ["*"],
        popupTemplate: templateHurricane
      });

      map.add(hurricane);

      hurricane.then(function() {
        view.animateTo(hurricane.fullExtent);
      });

     //  var templateSceneServiceLayer = new PopupTemplate({
     //    title: "San Diego",
     //    fieldInfos: [{ //define field infos so we can specify an alias
     //      fieldName: "radius",
     //      label: "radius:",
     //      visible: true
     //    }]
     //  });
      
     // var sceneServiceLayer = new SceneServiceLayer("http://5000k.esri.com/gis/rest/services/Hosted/SanDiegoBldgs/SceneServer/layers/0", {
     //   popupTemplate: templateSceneServiceLayer
     // });

     // map.add(sceneServiceLayer);
    });
    </script>
  </head>

  <body class="claro">
    <div id="map"></div>
  </body>

</html>
